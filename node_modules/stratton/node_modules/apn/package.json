{
  "name": "apn",
  "description": "An interface to the Apple Push Notification service for Node.js",
  "version": "1.0.7",
  "author": {
    "name": "Andrew Naylor",
    "email": "argon@mkbot.net"
  },
  "contributors": [
    {
      "name": "Andrew Naylor",
      "email": "argon@mkbot.net"
    }
  ],
  "keywords": [
    "apple",
    "push",
    "push notifications",
    "iOS",
    "apns"
  ],
  "main": "index.js",
  "repository": {
    "type": "git",
    "url": "http://github.com/argon/node-apn.git"
  },
  "engines": {
    "node": ">= 0.2.0 <0.4.0"
  },
  "readme": "#node-apn\n\nA Node.js module for interfacing with the Apple Push Notification service.\n\n## Features\n\n- Maintains a connection to the server to maximise notification batching\n- Enhanced binary interface support with error handling\n- Automatically sends unsent notifications if an error occurs\n- Feedback service support\n\n## Installation\n\nVia [npm][]:\n\n\t$ npm install apn\n\t\nAs a submodule of your project\n\n\t$ git submodule add http://github.com/argon/node-apn.git apn\n\t$ git submodule update --init\n\n## Usage\n### Load in the module\n\n\tvar apns = require('apn');\n\t\n### Connecting\nCreate a new connection to the gateway server using a dictionary of options. The defaults are listed below:\n\n\toptions =   { cert: 'cert.pem' /* Certificate file */\n\t\t\t\t, key:\t'key.pem'  /* Key file */\n\t\t\t\t, gateway: 'gateway.push.apple.com' /* gateway address */\n\t\t\t\t, port: 2195 /* gateway port */\n\t\t\t\t, enhanced: true /* enable enhanced format */\n\t\t\t\t, errorCallback: undefined /* Callback when error occurs */\n\t\t\t\t, cacheLength: 5 /* Notifications to cache for error purposes */\n\t\t\t\t};\n\t\n\tvar apnsConnection = new apns.connection(options);\n\n### Sending a notification\nTo send a notification first create a `Device` object. Pass it the device token as either a hexadecimal string, or alternatively as a `Buffer` object containing the binary token, setting the second argument to `false`.\n\n\tvar myDevice = new apns.device(token /*, ascii=true*/);\n\nNext create a notification object and set parameters. See the [payload documentation][pl] for more details\n\n\tvar note = new apns.notification();\n\t\n\tnote.badge = 3;\n\tnote.sound = \"ping.aiff\";\n\tnote.alert = \"You have a new message\";\n\tnote.payload = {'messageFrom': 'Caroline'};\n\tnote.device = myDevice;\n\t\n\tapnsConnection.sendNotification(note);\n\t\nThe above options will compile the following dictionary to send to the device:\n\n\t{\"messageFrom\":\"Caroline\",\"aps\":{\"badge\":3,\"sound\":\"ping.aiff\",\"alert\":\"You have a new message\"}}\n\t\n### Handling Errors\n\nIf the enhanced binary interface is enabled and an error occurs when sending a message then subsequent messages will be automatically resent* and the connection will be re-established. If an `errorCallback` is also specified in the connection options then it will be invoked with 2 arguments.\n\n1. The error number as returned from Apple. This can be compared to the predefined values in the `Errors` object.\n1. The notification object as it existed when the notification was converted and sent to the server.\n\n\\* N.B.: The `cacheLength` option specifies the number of sent notifications which will be cached for error handling purposes. At present if more than the specified number of notifications have been sent between the incorrect notification being sent and the error being received then no resending will occur. This is only envisaged within very high volume environments and a higher cache number might be desired.\n### Setting up the feedback service\n\nApple recommends checking the feedback service periodically for a list of devices for which there were failed delivery attempts.\n\nUsing the `Feedback` object it is possible to periodically query the server for the list. You should provide a function which will accept two arguments, the `time` returned by the server (epoch time) and a `Device` object containing the device token. You can also set the query interval in seconds. Again the default options are shown below.\n\n\toptions =\t{ cert: 'cert.pem' /* Certificate file */\n\t\t\t\t, key:\t'key.pem'  /* Key file */\n\t\t\t\t, address: 'feedback.push.apple.com' /* feedback address */\n\t\t\t\t, port: 2196 /* feedback port */\n\t\t\t\t, feedback: false /* callback function */\n\t\t\t\t, interval: 3600 /* query interval in seconds */\n\t\t\t\t};\n\n\tvar feedback = new apns.feedback(options);\n\n## Converting your APNs Certificate\n\nAfter requesting the certificate from Apple export your private key as a .p12 file and download the .cer file from the iOS Provisioning Portal.\n\nNow in the directory containing cert.cer and key.p12 execute the following commands to generate your .pem files:\n\n\t$ openssl x509 -in cert.cer -inform DER -outform PEM -out cert.pem\n\t$ openssl pkcs12 -in key.p12 -out key.pem -nodes\n\t\nIf you are using a development certificate you may wish to name them differently to enable fast switching between development and production. The filenames are configurable within the module options, so feel free to name them something more appropriate.\n\n## Credits\n\nWritten and maintained by [Andrew Naylor][mphys].\n\nSpecial thanks to [Ben Noordhuis][bnoordhuis] for `invoke_after` code.\n\n## License\n\nReleased under the MIT License\n\nCopyright (c) 2010 Andrew Naylor\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n[pl]: https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html#//apple_ref/doc/uid/TP40008194-CH100-SW1 \"Local and Push Notification Programming Guide: Apple Push Notification Service\"\n[mphys]: http://mphys.com\n[bnoordhuis]: http://bnoordhuis.nl\n[npm]: http://github.com/isaacs/npm\n\n## Changelog\n\n1.0.7:\n\n* Addresses an issue if the socket disconnects with queued notifications it would be reinitialised before its teardown is completed leaving the system in an undefined state.\n\n1.0.6:\n\n* Fixes issue #6 where a socket emitting an error could bring down the whole node instance as the exception is uncaught.\n\n1.0.5:\n\n* Fixed a bug with parsing device token which could cause an out-of-bounds error.\n\n1.0.4:\n\n* The 1.0.x tree is now a maintenance branch as the TLS API used has been deprecated as of node 0.4.0\n* Changed package.json to specify the inoperability of this version with node > 0.4.0\n\n1.0.3:\n\n* Fixes a typo in the documentation in this very file\n\n1.0.2:\n\n* Fixes critical issue with error callback not firing (Issue #1)\n\n1.0.1:\n\n* Moved some object methods into the prototype to save memory\n* Tidied up some connecting code\n* Introduced an `index.js` to make module loading tidier\n* Fixed a couple of typos. \n\n1.0.0: \n \n* Well I created a module; Version 0.0.0 had no code, and now it does, and it works, so that's pretty neat, right?",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/argon/node-apn/issues"
  },
  "_id": "apn@1.0.7",
  "_from": "apn@1.0.x"
}
